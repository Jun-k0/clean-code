# 단위 테스트



### TDD 법칙 세 가지 

- 첫째 : 실패하는 단위 테스트를 작성할 떄까지 실제 코드를 작성하지 않는다.
- 둘째 : 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위  테스트를 작성한다.
- 셋째 : 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.



위의 법칙들을 지키면서 짜게 되면 방대한 테스트 코드가 나옵니다. 이는 심각한 관리 문제를 유발하기도 합니다.

### 깨끗한 테스트 코드 유지하기

- 테스트 코드는 사고와 설계와 주의가 필요하므로 실제 코드 못지 않게 중요합니다. 

- *테스트는 유연성, 유지보수성, 재사용성을 제공한다.*
  - 테스트 케이스가 있으면 변경이 두렵지 않다! 
  - 그러므로, 실제 코드를 점검하는 자동화된 단위 테스트 슈트는 설계와 아키텍처를 최대한 깨끗하게 보존하는 열쇠입니다.
  - 따라서, 테스트 코드가 지저분할수록 실제 코드도 지저분해지고, 테스트 코드를 잃어버리고 실제 코드도 망가집니다.

### 깨끗한 테스트 코드 

- 가독성, 가독성, 가독성 이 제일 중요합니다! (세번 강조)

  - 뭉탱이로 만들지말고 더 잘게 쪼개서 테스트를 만들어야 합니다.

- *도메인에 특화된 테스트 언어*
  - 
- *이중 표준*

  ```swift
  // ❌ False, True로 판단하는 방식 지양
  assertFalse(hw.heaterState());
  assertTrue(hw.blowerState());
  assertFalse(hw.coolerState());
  
  // 👍 대문자, 소문자로 판단하는 방식이 가독성이 더 뛰어나다.
  assertEquals("HBc", hw.getState());
  ```

  위 예시는 임베디드 시스템을 테스트 하는 상황인데, 실제 환경은 절대로 안 되지만, 테스트 환경에서는 전혀 문제없는 방식입니다. 그래서 어쩌라는거지..?! 그래서! 테스트 코드 짤 때 굳이 실제 코드 짤 때처럼 효율을 엄청 생각해서 짤 필요는 없다고 스터디에서 얘기가 나왔습니다.

### 테스트 당 assert 하나

- `give-when-then` 이라는 관례를 사용하면 가독성이 좋다. 
  - 하지만, 중복되는 코드가 늘어나니, 다른 방법으로 중복 코드를 줄이는 것이 좋다. (여기서 다른 방법은, Java 언어에 관한 내용이라 생략)

- 테스트 당 개념 하나!!
  - `testAddMonths`함수는 여러가지를 테스트하게 된다.
    - (5월)30일로 끝나는 한 달을 더하면 날짜는 30일이 되어야지 31일이 되어서는 안된다.
    - (5월)두 달을 더하면 그리고 두번째 달이 31일로 끝나면 날짜는 31일이 되어야 한다. 
    - ... 등등
  - 이 이야기는 한 테스트 함수안에는 테스트하려는 개념하나만 도입되어야 좋습니다. 

### F.I.R.S.T

- Fast (빠르게) : 테스트는 빠르게 돌아가야한다.
- Independent (독립적으로) : 테스트끼리 서로 의존하면 안된다.
- Repeatable (반복가능하게) : 어떤 환경에서도 반복이 가능해야 합니다. (QA 환경, 네트워크에 연결되지 않는 환경 등) 테스트가 돌아가지 않는 환경이 하나라도 있다면 실패한 이유를 둘러댈 변명이 생기기 때문.
- Self-Validating (자가검증하는) : `Bool`값으로 결과를 내야 한다. 스스로 결과를 도출하게 만들어야 수작업 평가가 이루어질 수 있다.
- Timely (적시에): 테스트는 적시에 작성해야 한다. 단위 테스트는 테스트하려는 실제 코드를 구현하기 직전에 구현한다. 그래야 실젝 코드가 테스트하기 너무 어렵다고 판명날지 모르니까..



### 결론

- 테스트 코드는 실제 코드만큼이나 프로젝트 건강에 중요하다! 유연성, 유지보수성, 재사용성을 보존하고 강화하기 때문이다. 
- 그니까, 테스트 코드를 깨끗하게 작성하고 관리하자! 표현력을 높이고 간결하게 정리하자!
